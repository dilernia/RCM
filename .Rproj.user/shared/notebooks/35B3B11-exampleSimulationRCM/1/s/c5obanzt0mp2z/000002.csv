"0","# Generate individual variants with rho=0.2 and errors [-0.1,0.1] for common edges"
"0","set.seed(1994)"
"0","rm(list = ls())"
"0",""
"0","p <- 100"
"0",""
"0","# common graph "
"0",""
"0","G[1, 2:14] <- G[12, 15] <- G[13, 16] <- G[14, 17] <- G[17, 18] <- 1"
"0","G[1, 19] <- G[19, 20] <- G[19, 21] <- G[21, 22:23] <- G[23, 24] <- 1"
"0","G[1, 25] <- G[25, 26] <- 1"
"0","G[26, 36] <- G[36, 37:39] <- G[38, 40] <- G[39, 41] <- 1"
"0","G[26, 42] <- G[42, 43:44] <- G[44,45] <- 1"
"0","G[26, 46] <- G[46, 47] <- G[47, 48] <- G[48, 49:52] <- G[52, 53] <- 1"
"0","G[26, 54] <- 1"
"0","G[54, 67] <- G[67, 68:72] <- 1"
"0",""
"0","G[78, 79:82] <- G[81, 83] <- G[82, 84:85] <- 1"
"0","G[86, 87:92] <- G[90, 93] <- G[91, 94] <- G[92, 95:96] <- 1"
"0","G[86, 97] <- G[97, 98:99] <- G[99, 100] <- 1"
"0",""
"0","temp <- diag(0.5, p) + G * matrix(runif(p * p, 0.5, 1) * sample(c(-1, 1), p * p, replace = TRUE), p, p)"
"0","temp2 <- temp + t(temp) + diag(rowSums(G + t(G)) / 2)"
"0","any(eigen(temp2, only.values = T)$values <= 0)"
"1","[1]"
"1"," FALSE"
"1","
"
"0","Omega0.true <- diag(diag(temp2)^-0.5) %*% temp2 %*% diag(diag(temp2)^-0.5)"
"0","A[upper.tri(A)] <- 1 "
"0","A <- A-G"
"0","ind.0 <- which(A == 1)"
"0","ind.1 <- which(G == 1)"
"0",""
"0","K <- 8 "
"0","Gk <- Omegas.true <- array(0, c(p, p, K))"
"0",""
"0","dif.p <- 0.2 "
"0",""
"0","# Generating mechanism 1"
"0","for(k in 1:K) {"
"0","  ind.ak <- sample(ind.0, round(sum(G) * dif.p))"
"0","  ind.dk <- sample(ind.1, round(sum(G) * dif.p))"
"0","  ind.sm <- setdiff(ind.1, ind.dk)"
"0","  G.ak <- G.dk <- G.sm <- matrix(0, p, p)"
"0","  G.ak[ind.ak] <- 1"
"0","  G.dk[ind.dk] <- 1"
"0","  G.sm[ind.sm] <- 1"
"0","  "
"0","  temp.k = matrix(0, p, p)"
"0","    "
"0","    temp.ak <- G.ak * matrix(runif(p * p, 0.5, 1) * sample(c(-1, 1), p * p, replace = TRUE), p, p)"
"0","    temp.dk <- G.dk * temp"
"0","    temp.sm <- G.sm * matrix(runif(p * p, 0, es) * sample(c(-1, 1),p * p,replace = TRUE), p, p)"
"0","    temp.k <- temp + t(temp) - temp.dk - t(temp.dk) + temp.ak + t(temp.ak) + temp.sm + t(temp.sm) + "
"0","      diag(rowSums(G + t(G) + G.ak + t(G.ak) - G.dk - t(G.dk)) / 2)"
"0","  }"
"0","  Omegas.true[, , k] <- diag(diag(temp.k)^-0.5) %*% temp.k %*% diag(diag(temp.k)^-0.5)"
"0","  "
"0","  Gk[,,k] <- G + G.ak -G.dk"
"0","  "
"0","  cat(k,""is done \n"")"
"0","}"
"1","1"
"1"," "
"1","is done 
"
"1","is done 
"
"1","3"
"1"," "
"1","is done 
"
"1","4"
"1"," "
"1","5"
"1"," "
"1","6"
"1"," "
"1","7"
"1"," "
"1","is done 
"
"1","8"
"1"," "
"1","is done 
"
"0","Gk.true <- Gk"
"0",""
"0","sim.dat <- rep(list(NA),K)"
"0","for(k in 1:K) {"
"0","}"
"0",""
