"0","# Function for summarizing edge detection performances"
"0","performanceSummary <- function(Omegaks, Omegags, Omega0ks = Omegas.true, Omega0g = Omega0.true) {"
"0",""
"0","# Calculating Precision Matrix Error, True Positive Rate, and False Positive Rates"
"0","subjSum <- sum(sapply(1:K, FUN = function(k){sum((adj(Omegaks[, , k]) +"
"0","                                                    adj(Omega0ks[, , k]))[lower.tri(Omega0ks[, , k], diag = FALSE)] == 2)}))"
"0",""
"0","TPRk <- subjSum / posskEdges"
"0","subjSum0 <- sum(sapply(1:K, FUN = function(k){sum((-1*adj(Omegaks[, , k]) +"
"0","                                                     adj(Omega0ks[, , k]))[lower.tri(Omega0ks[, , k], diag = FALSE)] == -1)}))"
"0","possk0s <- sum(sapply(1:K, FUN = function(k){sum(adj(Omega0ks[, , k])[lower.tri(Omega0ks[, , k], diag = FALSE)] == 0)}))"
"0",""
"0","FPRk <- subjSum0 / possk0s"
"0",""
"0","PrecisionK <- subjSum / (subjSum + subjSum0)"
"0",""
"0","F1k <- 2*(PrecisionK*TPRk) / (PrecisionK + TPRk)"
"0",""
"0","  grpSum <- sum((adj(Omegags) + adj(Omega0g))[lower.tri(Omega0g, diag = FALSE)] == 2)"
"0","  possgEdges <- sum(sapply(1:G, FUN = function(g){sum(adj(Omega0g)[lower.tri(Omega0g, diag = FALSE)] == 1)}))"
"0","  TPRg <- grpSum / possgEdges"
"0","  possg0s <- sum(adj(Omega0g)[lower.tri(Omega0g, diag = FALSE)] == 0)"
"0",""
"0","  PrecisionG <- grpSum / (grpSum + grpSum0)"
"0",""
"0","  F1g <- 2*(PrecisionG*TPRg) / (PrecisionG + TPRg)"
"0",""
"0","  FPRg <- grpSum0 / possg0s"
"0",""
"0","return(data.frame(TPRk = TPRk, FPRk = FPRk,"
"0","                  PrecisionK = PrecisionK, F1k = F1k,"
"0","}"
